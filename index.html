<!DOCTYPE html>
<html>

<head>
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/@mdi/font@6.x/css/materialdesignicons.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
  <style>
    .v-data-table>.v-data-table__wrapper>table>tbody>tr>th.group-maturite-jours {
      font-size: .875rem;
    }

    .day-links .v-chip a {
      color: black;
      text-decoration: none;
    }
  </style>
</head>

<body>
  <div id="app">
    <v-app>
      <v-main>
        <v-tabs>
          <v-tab key="stabilitywarrants">Stability warrants</v-tab>
          <v-tab key="portfolio" v-show="portfolio.length > 0">Portfolio</v-tab>
          <v-tab key="debug">Debug</v-tab>

          <v-tab-item key="stabilitywarrants">
            <v-container fluid>
              <v-row no-gutters>
                <v-chip-group label="MaturitÃ© jours" v-model="filtermaturitydays" column multiple
                  active-class="primary--text">
                  <v-chip filter v-for="maturityday in maturitydays" :value="maturityday" :key="maturityday">
                    {{(maturityday - 30) + ' - ' + maturityday + 'J'}}
                  </v-chip>
                </v-chip-group>
                <v-switch v-model="filterperf" label="Perf Max > 8% & Perf Min > 15%">
                </v-switch>
                <v-select v-model="filtersousjacent" :items="sousjacents" label="Sous-jacent" solo dense>
                </v-select>
                <issuer-filter v-model="filterissuers" :warrants="warrants"></issuer-filter>
              </v-row>
              <v-row no-gutters>
                <pivot-point v-model="pivotpoint"></pivot-point>
              </v-row>
              <v-row no-gutters>
                <v-col>
                  <v-data-table :headers="headers" :items="filteredWarrants"
                    :sort-by="['sous-jacent', 'plage','ecartcibleabs']" :sort-desc="[false, true, false]"
                    :footer-props="{'items-per-page-options': [-1,50,100]}" multi-sort dense class="elevation-1">
                    <template v-slot:item.isin="{item}">
                      <a :href="bourso(item)" target="_blank">{{item.isin}}</a>
                    </template>
                  </v-data-table>
                </v-col>
              </v-row>
            </v-container>
          </v-tab-item key="portfolio">
          <v-tab-item fluid>
            <v-container>
              <v-row no-gutters>
                <v-col>Total +/- latentes: <span
                    :style="getPvStyle(capitalGains.pvlatentes)">{{capitalGains.pvlatentes}}</span>
                </v-col>
                <v-col>Total +/- potentielles: <span
                    :style="getPvStyle(capitalGains.pvpotentielles)">{{capitalGains.pvpotentielles}}</span>
                </v-col>
              </v-row>
              <v-row no-gutters>
                <pivot-point v-model="pivotpoint"></pivot-point>
              </v-row>
              <v-row no-gutters>
                <v-col>
                  <v-data-table :headers="portfolioHeaders" :items="portfolioWarrants"
                    :sort-by="['maturitejours','sous-jacent','plage']" :sort-desc="[false,false, true, false]"
                    :footer-props="{'items-per-page-options': [-1,50,100]}" multi-sort dense group-by="maturitejours"
                    class="elevation-1">
                    <template v-slot:item.isin="{item}">
                      <a :href="bourso(item)" target="_blank">{{item.isin}}</a>
                    </template>
                    <template v-slot:item.perfmin="{item}">
                      <span :style="getPerfStyle(item.perfmin)">{{item.perfmin}}</span>
                    </template>
                    <template v-slot:item.perfmax="{item}">
                      <span :style="getPerfStyle(item.perfmax)">{{item.perfmax}}</span>
                    </template>
                    <template v-slot:item.pvlatentes="{item}">
                      <span :style="getPvStyle(item.pvlatentes)">{{item.pvlatentes}}</span>
                    </template>
                    <template v-slot:item.pvpotentielles="{item}">
                      <span :style="getPvStyle(item.pvpotentielles)">{{item.pvpotentielles}}</span>
                    </template>
                    <template v-slot:group.header="{items, isOpen, toggle}">
                      <th class="group-maturite-jours" colspan="2">
                        {{portfolioHeaders[5].text}}: {{ items[0].maturitejours }}
                      </th>
                      <th :colspan="portfolioHeaders.length-6"></th>
                      <th class="group-maturite-jours"><span :style="getPvStyle(sumPvlatentes(items[0].maturitejours))">
                          {{sumPvlatentes(items[0].maturitejours)}}</span>
                      </th>
                      <th></th>
                      <th class="group-maturite-jours"><span
                          :style="getPvStyle(sumPvpotentielles(items[0].maturitejours))">
                          {{sumPvpotentielles(items[0].maturitejours)}}</span>
                      </th>
                    </template>
                  </v-data-table>
                </v-col>
              </v-row>
            </v-container>
          </v-tab-item>
          <v-tab-item key="debug">
            <v-container>
              <v-row no-gutters>
                <v-col>
                  <v-chip-group label="Semaine" v-model="dates" class="day-links">
                    <v-chip link v-for="(date, index) in dates" :value="date" :key="index">
                      <a :href="'index.html'+index==0?'':'?date='+date.string">
                        {{date.string}}</a>
                    </v-chip>
                  </v-chip-group>


                  </br>
                  <ul>
                    <li> <a :href="'index.html?portfolio='+portfoliocodes(false)" style="word-wrap: break-word">
                        index.html?portfolio={{portfoliocodes(false)}}</a>
                    </li>
                    <li> <a :href="'index.html?portfolio='+portfoliocodes(true)" style="word-wrap: break-word">
                        index.html?portfolio={{portfoliocodes(true)}}</a>
                    </li>
                  </ul>
                </v-col>
              </v-row>
              <v-row>
                <v-textarea v-model="boursoPortfolio" label="Default style"></v-textarea>
                <v-btn @click="extractPortfolioFromText">Importer les valeurs du compte titre</v-btn>
              </v-row>
            </v-container>
          </v-tab-item>
        </v-tabs>
      </v-main>
    </v-app>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/http-vue-loader@1.4.2/src/httpVueLoader.min.js"></script>
  <script src="stabilitywarrants.js"></script>


</body>

</html>