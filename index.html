<!DOCTYPE html>
<html>

<head>
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/@mdi/font@6.x/css/materialdesignicons.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
  <style>
    .v-data-table>.v-data-table__wrapper>table>tbody>tr>th.group-maturite-jours {
      font-size: .875rem;
    }

    .day-links .v-chip a {
      color: black;
      text-decoration: none;
    }
  </style>
</head>

<body>
  <div id="app">
    <v-app>
      <v-main>
        <v-tabs>
          <v-tab key="stabilitywarrants">Stability warrants</v-tab>
          <v-tab key="portfolio" v-show="portfolio.length > 0">Portfolio</v-tab>
          <v-tab key="debug">Debug</v-tab>

          <v-tab-item key="stabilitywarrants">
            <v-container fluid>
              <v-row no-gutters>
                <maturity-filter v-model="filtermaturity" :warrants="warrants"></maturity-filter>
                <v-switch v-model="filterperf" label="Perf Max > 12% & Perf Min > 15%">
                </v-switch>
                <!--
                <v-select v-model="filtersousjacent" :items="sousjacents" label="Sous-jacent" solo dense>
                </v-select>
-->
                <v-chip-group v-model="filtersousjacent" column active-class="primary--text">
                  <v-chip filter value="CAC 40" key="CAC 40">CAC 40</v-chip>
                  <v-chip filter value="DAX" key="DAX">DAX</v-chip>
                </v-chip-group>
                <issuer-filter v-model="filterissuers" :warrants="warrants"></issuer-filter>
              </v-row>
              <v-row no-gutters>
                <pivot-point v-if="ppArray.length > 0" v-model="ppArray[0]"></pivot-point>
              </v-row>
              <v-row no-gutters>
                <pivot-point v-if="ppArray.length > 0" v-model="ppArray[1]"></pivot-point>
              </v-row>
              <v-row no-gutters>
                <v-col>
                  <table-stabilitywarrants :headers="headers" :items="filteredWarrants"
                    :sort-by="['sous-jacent', 'plage', 'ecartcibleabs']" :sort-desc="[false, true, false]"
                    :footer-props="{ 'items-per-page-options': [-1, 50, 100] }"></table-stabilitywarrants>
                </v-col>
              </v-row>
            </v-container>
          </v-tab-item>
          <v-tab-item key="portfolio">
            <v-container fluid>
              <v-row no-gutters>
                <pivot-point
                  v-if="isPPLoaded && portfolioWarrants.filter(warrant => warrant['sous-jacent'] == 'CAC 40').length > 0"
                  v-model="pivotpoint['CAC 40'][0]"></pivot-point>
              </v-row>
              <v-row no-gutters>
                <pivot-point
                  v-if="isPPLoaded && portfolioWarrants.filter(warrant => warrant['sous-jacent'] == 'CAC 40').length > 0"
                  v-model="pivotpoint['CAC 40'][1]"></pivot-point>
              </v-row>
              <v-row no-gutters>
                <pivot-point
                  v-if="isPPLoaded && portfolioWarrants.filter(warrant => warrant['sous-jacent'] == 'DAX').length > 0"
                  v-model="pivotpoint['DAX'][0]"></pivot-point>
              </v-row>
              <v-row no-gutters>
                <pivot-point
                  v-if="isPPLoaded && portfolioWarrants.filter(warrant => warrant['sous-jacent'] == 'DAX').length > 0"
                  v-model="pivotpoint['DAX'][1]"></pivot-point>
              </v-row>
              <v-row no-gutters>
                <v-col>Total +/- latentes: <span
                    :style="getPvStyle(capitalGains.pvlatentes)">{{capitalGains.pvlatentes}}</span>
                </v-col>
                <v-col>Total +/- potentielles: <span
                    :style="getPvStyle(capitalGains.pvpotentielles)">{{capitalGains.pvpotentielles}}</span>
                </v-col>
                <v-col>Montant total: {{portfolioWarrantsTotalAmount}}</span>
                </v-col>
              </v-row>
              <v-row no-gutters>
                <v-col>
                  <table-portfolio :headers="portfolioHeaders" :items="portfolioWarrants"
                    :sort-by="['maturitejours', 'sous-jacent', 'plage']" :sort-desc="[false, false, true, false]"
                    :footer-props="{ 'items-per-page-options': [-1, 50, 100] }">
                  </table-portfolio>
                </v-col>
              </v-row>
            </v-container>
          </v-tab-item>
          <v-tab-item key="debug">
            <v-container>
              <v-row no-gutters>
                <v-col>
                  <h1 class="text-subtitle-1">
                    <v-icon color="gray darken-2">mdi-clock-remove-outline</v-icon>&nbsp;Par Date
                  </h1>
                  <v-chip-group label="Semaine" v-model="dates" class="day-links">
                    <v-chip link v-for="(date, index) in dates" :value="date" :key="index">
                      <a :href="'index.html'+index==0?'':'?date='+date.string">
                        {{date.string}}
                      </a>
                    </v-chip>
                  </v-chip-group>
                  <h1 class="text-subtitle-1">
                    <v-icon color="gray darken-2">mdi-credit-card-clock</v-icon>&nbsp;Par date avec compte titres
                  </h1>
                  <v-chip-group label="Semaine" v-model="dates" class="day-links">
                    <v-chip link v-for="(date, index) in dates" :value="date" :key="index">
                      <a :href="'index.html?'+(index==0?'':'date='+date.string+'&')+'portfolio='+portfoliocodes(false)">
                        {{date.string}}
                      </a>
                    </v-chip>
                  </v-chip-group>
                </v-col>
              </v-row>
              <v-row>
                <v-col>
                  <h1 class="text-subtitle-1">
                    <v-icon color="gray darken-2">mdi-credit-card-refresh</v-icon>&nbsp;Import du compte titres
                  </h1>
                  <v-textarea v-model="boursoPortfolio" label="Texte copier/coller"></v-textarea>
                  <v-btn @click="extractPortfolioFromText">Importer les valeurs</v-btn>
                  <v-file-input hide-input accept=".csv,.txt" label="Export des positions au format csv"
                    v-model="chosenFile" @change="loadPortfolio" style="display: inline-block;">
                  </v-file-input>
                </v-col>
              </v-row>
            </v-container>
          </v-tab-item>
        </v-tabs>
      </v-main>
    </v-app>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/http-vue-loader@1.4.2/src/httpVueLoader.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vue3-sfc-loader/dist/vue2-sfc-loader.js"></script>
  <script src="/vuejs/src/components/table-mixin.js"></script>
  <script src="stabilitywarrants.js"></script>


</body>

</html>